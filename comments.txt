Здравствуйте, Кирилл.
Я общался с преподавателем о том, чтобы собрать из двух дагов один, он мне написал это:

"У тебя две независимые друг от друга задачи
Которые нужно запускать в абсолютно разное время
Выполнение которых не зависит друг от друга
Если тебе нужно перезалить исторические данные, то что делать?
Как запустить это без инкремента?"

Поэтому собирать из двух дагов один не стал.
Все остальное подправил, добавил логирование, переименовал переменные и т.д.
Дополнительно добавил даг для определения дня недели, так как одна из них у нас имеет недельный срез.
Поменял код для первой витрины, чтобы ее заполнение было идемпотенто и добавил ограничение уникальности на таблицу при создании схемы.
