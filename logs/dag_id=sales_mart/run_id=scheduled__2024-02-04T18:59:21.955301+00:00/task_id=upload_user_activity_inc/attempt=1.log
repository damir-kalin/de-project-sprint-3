[2024-02-11 19:02:13,528] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: sales_mart.upload_user_activity_inc scheduled__2024-02-04T18:59:21.955301+00:00 [queued]>
[2024-02-11 19:02:13,533] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: sales_mart.upload_user_activity_inc scheduled__2024-02-04T18:59:21.955301+00:00 [queued]>
[2024-02-11 19:02:13,533] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2024-02-11 19:02:13,533] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2024-02-11 19:02:13,533] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2024-02-11 19:02:13,540] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): upload_user_activity_inc> on 2024-02-04 18:59:21.955301+00:00
[2024-02-11 19:02:13,542] {standard_task_runner.py:52} INFO - Started process 13352 to run task
[2024-02-11 19:02:13,544] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales_mart', 'upload_user_activity_inc', 'scheduled__2024-02-04T18:59:21.955301+00:00', '--job-id', '292', '--raw', '--subdir', 'DAGS_FOLDER/sprint3.py', '--cfg-path', '/tmp/tmpt175b221', '--error-file', '/tmp/tmpzm73bbtg']
[2024-02-11 19:02:13,544] {standard_task_runner.py:80} INFO - Job 292: Subtask upload_user_activity_inc
[2024-02-11 19:02:13,575] {task_command.py:369} INFO - Running <TaskInstance: sales_mart.upload_user_activity_inc scheduled__2024-02-04T18:59:21.955301+00:00 [running]> on host 2a8d1eb5116f
[2024-02-11 19:02:13,611] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=student@example.com
AIRFLOW_CTX_DAG_OWNER=student
AIRFLOW_CTX_DAG_ID=sales_mart
AIRFLOW_CTX_TASK_ID=upload_user_activity_inc
AIRFLOW_CTX_EXECUTION_DATE=2024-02-04T18:59:21.955301+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-02-04T18:59:21.955301+00:00
[2024-02-11 19:02:13,618] {logging_mixin.py:115} INFO - https://storage.yandexcloud.net/s3-sprint3/cohort_22/damir-kalinin7/project/MjAyNC0wMi0wNFQwMDowMDowMAlUV3BCZVU1RE1IZE5hVEI0VFZaUmVFOUViekZQVkc4d1RtZHNhMWxYTVhCamFURnlXVmQ0Y0dKdGJIVk9kejA5/user_activity_log_inc.csv
[2024-02-11 19:02:13,618] {logging_mixin.py:115} INFO - 20240204_user_activity_log_inc.csv
[2024-02-11 19:02:13,937] {logging_mixin.py:115} INFO - b'id,uniq_id,date_time,action_id,customer_id,quantity\r\n1,6430164f7bd9bca469913da7f903bdf3,2024-02-04T00:00:00,1,531,19\r\n2,eda21262bc9b49a2d01fe0e686696913,2024-02-04T00:00:00,1,180,24\r\n3,2ff9f368659ce0910bfa74a96ba6198d,2024-02-04T00:00:00,3,441,0\r\n4,c248137d9590ad495bb191644d7c132a,2024-02-04T00:00:00,3,131,5\r\n'
[2024-02-11 19:02:13,940] {logging_mixin.py:115} INFO - Index(['id', 'uniq_id', 'date_time', 'action_id', 'customer_id', 'quantity'], dtype='object')
[2024-02-11 19:02:13,941] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/lessons/dags/sprint3.py", line 101, in upload_data_to_staging
    df=df.drop('id', axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4948, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4279, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4323, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6644, in drop
    raise KeyError(f"{list(labels[mask])} not found in axis")
KeyError: "['id'] not found in axis"
[2024-02-11 19:02:13,952] {taskinstance.py:1395} INFO - Marking task as FAILED. dag_id=sales_mart, task_id=upload_user_activity_inc, execution_date=20240204T185921, start_date=20240211T190213, end_date=20240211T190213
[2024-02-11 19:02:13,958] {standard_task_runner.py:92} ERROR - Failed to execute job 292 for task upload_user_activity_inc ("['id'] not found in axis"; 13352)
[2024-02-11 19:02:13,997] {local_task_job.py:156} INFO - Task exited with return code 1
[2024-02-11 19:02:14,017] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
