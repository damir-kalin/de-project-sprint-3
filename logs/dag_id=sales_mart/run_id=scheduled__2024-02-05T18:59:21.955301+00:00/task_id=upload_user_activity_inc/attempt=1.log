[2024-02-11 19:02:30,663] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: sales_mart.upload_user_activity_inc scheduled__2024-02-05T18:59:21.955301+00:00 [queued]>
[2024-02-11 19:02:30,668] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: sales_mart.upload_user_activity_inc scheduled__2024-02-05T18:59:21.955301+00:00 [queued]>
[2024-02-11 19:02:30,668] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2024-02-11 19:02:30,668] {taskinstance.py:1357} INFO - Starting attempt 1 of 1
[2024-02-11 19:02:30,668] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2024-02-11 19:02:30,674] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): upload_user_activity_inc> on 2024-02-05 18:59:21.955301+00:00
[2024-02-11 19:02:30,676] {standard_task_runner.py:52} INFO - Started process 13643 to run task
[2024-02-11 19:02:30,678] {standard_task_runner.py:79} INFO - Running: ['airflow', 'tasks', 'run', 'sales_mart', 'upload_user_activity_inc', 'scheduled__2024-02-05T18:59:21.955301+00:00', '--job-id', '301', '--raw', '--subdir', 'DAGS_FOLDER/sprint3.py', '--cfg-path', '/tmp/tmps62u79nz', '--error-file', '/tmp/tmpg1nekco_']
[2024-02-11 19:02:30,678] {standard_task_runner.py:80} INFO - Job 301: Subtask upload_user_activity_inc
[2024-02-11 19:02:30,708] {task_command.py:369} INFO - Running <TaskInstance: sales_mart.upload_user_activity_inc scheduled__2024-02-05T18:59:21.955301+00:00 [running]> on host 2a8d1eb5116f
[2024-02-11 19:02:30,742] {taskinstance.py:1569} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_EMAIL=student@example.com
AIRFLOW_CTX_DAG_OWNER=student
AIRFLOW_CTX_DAG_ID=sales_mart
AIRFLOW_CTX_TASK_ID=upload_user_activity_inc
AIRFLOW_CTX_EXECUTION_DATE=2024-02-05T18:59:21.955301+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2024-02-05T18:59:21.955301+00:00
[2024-02-11 19:02:30,749] {logging_mixin.py:115} INFO - https://storage.yandexcloud.net/s3-sprint3/cohort_22/damir-kalinin7/project/MjAyNC0wMi0wNVQwMDowMDowMAlUV3BCZVU1RE1IZE5hVEI0VFZaUmVFOUViekZQVkc4eFRrRnNhMWxYTVhCamFURnlXVmQ0Y0dKdGJIVk9kejA5/user_activity_log_inc.csv
[2024-02-11 19:02:30,749] {logging_mixin.py:115} INFO - 20240205_user_activity_log_inc.csv
[2024-02-11 19:02:31,012] {logging_mixin.py:115} INFO - b'id,uniq_id,date_time,action_id,customer_id,quantity\r\n1,4e293fde62a7e5d4035c206c5d9df6a5,2024-02-05T00:00:00,2,910,17\r\n2,f4452f16387feddc534f5a3faeaf979b,2024-02-05T00:00:00,3,280,17\r\n3,803eac2da55030b4b0ec7ebe2d43064a,2024-02-05T00:00:00,1,510,24\r\n4,cf75002c2df0d47a01517403740fc9ab,2024-02-05T00:00:00,3,381,8\r\n5,83b0456912e56993daa5c1014bcf55ae,2024-02-05T00:00:00,0,361,15\r\n6,263115be3a8b7d402b9a7c6d8cef7aa3,2024-02-05T00:00:00,2,731,1\r\n7,c037edaf69264633fa5dad4d9b12a3af,2024-02-05T00:00:00,2,840,9\r\n8,93efabacf11ef239916447e2b0a7fc4d,2024-02-05T00:00:00,0,551,7\r\n9,4e2239bba479f8eaeaa49ab9334a7fd8,2024-02-05T00:00:00,3,50,5\r\n10,50bd038baa396e54d0aaa332edea3988,2024-02-05T00:00:00,1,560,10\r\n11,ab7ea7e4099c8480cf6a6c2b82c8775f,2024-02-05T00:00:00,3,471,13\r\n12,ad326638539b235de10f8aa62af90384,2024-02-05T00:00:00,1,750,5\r\n13,7eaf041989a02c86d1a6d3f9c047a6cb,2024-02-05T00:00:00,3,280,16\r\n'
[2024-02-11 19:02:31,015] {logging_mixin.py:115} INFO - Index(['id', 'uniq_id', 'date_time', 'action_id', 'customer_id', 'quantity'], dtype='object')
[2024-02-11 19:02:31,016] {taskinstance.py:1889} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/usr/local/lib/python3.8/dist-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/lessons/dags/sprint3.py", line 101, in upload_data_to_staging
    df=df.drop('id', axis=1)
  File "/usr/local/lib/python3.8/dist-packages/pandas/util/_decorators.py", line 311, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/frame.py", line 4948, in drop
    return super().drop(
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4279, in drop
    obj = obj._drop_axis(labels, axis, level=level, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/generic.py", line 4323, in _drop_axis
    new_axis = axis.drop(labels, errors=errors)
  File "/usr/local/lib/python3.8/dist-packages/pandas/core/indexes/base.py", line 6644, in drop
    raise KeyError(f"{list(labels[mask])} not found in axis")
KeyError: "['id'] not found in axis"
[2024-02-11 19:02:31,025] {taskinstance.py:1395} INFO - Marking task as FAILED. dag_id=sales_mart, task_id=upload_user_activity_inc, execution_date=20240205T185921, start_date=20240211T190230, end_date=20240211T190231
[2024-02-11 19:02:31,031] {standard_task_runner.py:92} ERROR - Failed to execute job 301 for task upload_user_activity_inc ("['id'] not found in axis"; 13643)
[2024-02-11 19:02:31,052] {local_task_job.py:156} INFO - Task exited with return code 1
[2024-02-11 19:02:31,073] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
